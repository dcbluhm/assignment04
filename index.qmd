---
title: "Data Science for Public Policy"
subtitle: "Assignment 04"
author: "David Bluhm - db1597"
execute:
  warning: false
format:
  html:
    embed-resources: true
---
D.C. Capital Bikeshare Data Visualizations

All data sourced from  
[Capital Bikeshare](https://s3.amazonaws.com/capitalbikeshare-data/index.html)

# Data Set-Up 

```{r}
library(tidyverse)
library(lubridate)
library(readr)

cabi_jan <- read_csv("data/202501-capitalbikeshare-tripdata.csv")

cabi_jul <- read_csv("data/202407-capitalbikeshare-tripdata.csv")

cabi_combined <- rbind(cabi_jan, cabi_jul)

cabi_combined$started_at <- as.POSIXct(cabi_combined$started_at)

cabi_combined <- cabi_combined |>
  mutate(month = if_else(year(started_at) == 2025, "January", "July"))
```

# Visualization 1
Classic vs. E-Bike Breakdown over January
```{r}
cabi_jan |>
  ggplot(mapping = aes(x = started_at))+
  geom_density(mapping = aes(fill = rideable_type),
               alpha = .4)+
  scale_fill_manual(values = c("electric_bike" = "dodgerblue",
                               "classic_bike" = "firebrick3"),
                    labels = c("electric_bike" = "Electric Bike",
                               "classic_bike" = "Classic Bike"))+
  labs(title = "A Greater Proportion of Capital Bikeshare Rides Were Taken Later in January",
       subtitle = "Density of rides taken in January 2025, split by bike type",
       caption = "Data Source: Capital Bikeshare", 
       fill = "Bike Type",
       y = "Density")+
  theme_minimal()+
  theme(
    plot.title = element_text(face = "bold"),
    axis.title.x = element_blank(),
    axis.text.y = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
  
  
```
This graph visualizes ridership trends for Capital Bikeshare, a bike rental company that provides additional mobility options for D.C. residents. The graph shows that external factors can severely decrease ridership rates, like the snowstorm that occurred on January 6th and the cold temperatures (and potential inauguration chaos) on January 20th. The weather at the end of January was much nicer, with temperatures reaching up to 62 degrees, which coincides with when the number of classic bike rides was greater than e-bikes. With this information, policy makers can anticipate how external factors may affect ridership going forward, taking necessary steps like ensuring stations are stocked with classic bikes during warm days. 

# Visualization 2
Stacked bar by days of week
```{r}
cabi_combined <- cabi_combined |>
  mutate(day_of_week = weekdays(started_at))
           
cabi_combined$day_of_week <- factor(cabi_combined$day_of_week, levels = c("Sunday","Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))

cabi_counts <- cabi_combined |>
  group_by(month, day_of_week, rideable_type) |>
  summarise(count = n())

cabi_counts |>
  ggplot(mapping = aes(x = day_of_week,
                       y = count,
                       fill = rideable_type)) +
  geom_bar(stat = "identity") +
    scale_fill_manual(values = c("electric_bike" = "dodgerblue",
                               "classic_bike" = "firebrick3"),
                    labels = c("electric_bike" = "Electric Bike",
                               "classic_bike" = "Classic Bike"))+
  labs(title = "Most Capital Bikeshare Rides Happen During the Workweek",
       subtitle = "Count of classic and e-bike rides taken for each day of the week in July 2024 and January 2025",
       caption = "Data Source: Capital Bikeshare", 
       fill = "Bike Type")+
  theme_minimal()+
  theme(
    plot.title = element_text(face = "bold"),
    axis.title.x = element_blank(),
    axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
    axis.title.y = element_blank(),
    axis.text.y = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank()) +
  facet_wrap(~month)

```
This visualization shows how Capital Bikeshare ridership varies throughout the week. For both summer and winter months the peak day of the week is during the workweek, showing that many people use Capital Bikeshare for their commute. Policymakers can utilize this information to make additional preparations during the these specific weekdays when more people are riding, like ensuring bikes are distributed to all stations and having prompt pickups for broken bikes that have had maintenance requests. This would help make biking a viable transit option for more D.C. residents.

# Visualization 3
Stacked bar by time of day or length of time hist
```{r}

  
```
This visualization...

# Visualization 4
Map
```{r}

  
```
This visualization...
